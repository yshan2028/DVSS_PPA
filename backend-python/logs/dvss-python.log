2025-07-06 05:09:07 - test_server - INFO - test_server.py:20 - Starting DVSS-PPA application...
2025-07-06 05:09:07 - test_server - ERROR - test_server.py:27 - Failed to create database tables: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-06 05:09:07 - test_server - WARNING - test_server.py:28 - Application will continue without database
2025-07-06 05:09:07 - test_server - INFO - test_server.py:30 - DVSS-PPA application started successfully
2025-07-06 05:12:23 - test_server - INFO - test_server.py:35 - Shutting down DVSS-PPA application...
2025-07-06 05:13:21 - server - INFO - server.py:133 - All routers registered successfully
2025-07-06 05:13:22 - server - INFO - server.py:133 - All routers registered successfully
2025-07-06 05:13:22 - server - INFO - server.py:133 - All routers registered successfully
2025-07-06 05:13:22 - server - INFO - server.py:29 - Starting DVSS-PPA application...
2025-07-06 05:13:22 - server - ERROR - server.py:36 - Failed to create database tables: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-06 05:13:38 - server - INFO - server.py:133 - All routers registered successfully
2025-07-06 05:13:38 - server - INFO - server.py:133 - All routers registered successfully
2025-07-06 05:13:38 - server - INFO - server.py:29 - Starting DVSS-PPA application...
2025-07-06 05:13:38 - server - ERROR - server.py:36 - Failed to create database tables: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-06 05:13:38 - server - WARNING - server.py:37 - Application will continue without database
2025-07-06 05:13:38 - server - ERROR - server.py:45 - Failed to connect to Redis: Error 61 connecting to localhost:6379. Connection refused.
2025-07-06 05:13:38 - server - WARNING - server.py:47 - Application will continue without Redis
2025-07-06 05:13:38 - server - INFO - server.py:49 - DVSS-PPA application started successfully
2025-07-06 05:13:54 - server - INFO - server.py:133 - All routers registered successfully
2025-07-06 05:14:13 - server - INFO - server.py:133 - All routers registered successfully
2025-07-06 05:14:14 - server - INFO - server.py:133 - All routers registered successfully
2025-07-06 05:14:14 - server - INFO - server.py:133 - All routers registered successfully
2025-07-06 05:14:14 - server - INFO - server.py:29 - Starting DVSS-PPA application...
2025-07-06 05:14:14 - server - ERROR - server.py:36 - Failed to create database tables: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-06 05:14:14 - server - WARNING - server.py:37 - Application will continue without database
2025-07-06 05:14:14 - server - ERROR - server.py:45 - Failed to connect to Redis: Error 61 connecting to localhost:6379. Connection refused.
2025-07-06 05:14:14 - server - WARNING - server.py:47 - Application will continue without Redis
2025-07-06 05:14:14 - server - INFO - server.py:49 - DVSS-PPA application started successfully
2025-07-06 05:15:37 - server - INFO - server.py:54 - Shutting down DVSS-PPA application...
2025-07-06 05:15:38 - server - INFO - server.py:133 - All routers registered successfully
2025-07-06 05:15:38 - server - INFO - server.py:133 - All routers registered successfully
2025-07-06 05:15:38 - server - INFO - server.py:29 - Starting DVSS-PPA application...
2025-07-06 05:15:38 - server - ERROR - server.py:36 - Failed to create database tables: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-06 05:15:38 - server - WARNING - server.py:37 - Application will continue without database
2025-07-06 05:15:38 - server - ERROR - server.py:45 - Failed to connect to Redis: Error 61 connecting to localhost:6379. Connection refused.
2025-07-06 05:15:38 - server - WARNING - server.py:47 - Application will continue without Redis
2025-07-06 05:15:38 - server - INFO - server.py:49 - DVSS-PPA application started successfully
2025-07-06 05:17:30 - server - INFO - server.py:54 - Shutting down DVSS-PPA application...
2025-07-06 05:17:30 - server - INFO - server.py:133 - All routers registered successfully
2025-07-06 05:17:30 - server - INFO - server.py:133 - All routers registered successfully
2025-07-06 05:17:30 - server - INFO - server.py:29 - Starting DVSS-PPA application...
2025-07-06 05:17:30 - server - ERROR - server.py:36 - Failed to create database tables: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-06 05:17:30 - server - WARNING - server.py:37 - Application will continue without database
2025-07-06 05:17:30 - server - ERROR - server.py:45 - Failed to connect to Redis: Error 61 connecting to localhost:6379. Connection refused.
2025-07-06 05:17:30 - server - WARNING - server.py:47 - Application will continue without Redis
2025-07-06 05:17:30 - server - INFO - server.py:49 - DVSS-PPA application started successfully
2025-07-06 13:19:14 - server - INFO - server.py:133 - All routers registered successfully
2025-07-06 13:19:15 - server - INFO - server.py:133 - All routers registered successfully
2025-07-06 13:19:15 - server - INFO - server.py:133 - All routers registered successfully
2025-07-06 13:19:15 - server - INFO - server.py:29 - Starting DVSS-PPA application...
2025-07-06 13:19:15 - server - ERROR - server.py:36 - Failed to create database tables: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-06 13:19:15 - server - WARNING - server.py:37 - Application will continue without database
2025-07-06 13:19:15 - server - ERROR - server.py:45 - Failed to connect to Redis: Error 61 connecting to localhost:6379. Connection refused.
2025-07-06 13:19:15 - server - WARNING - server.py:47 - Application will continue without Redis
2025-07-06 13:19:15 - server - INFO - server.py:49 - DVSS-PPA application started successfully
2025-07-06 13:20:14 - user_dao - ERROR - user_dao.py:168 - Get all users error: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-06 13:20:14 - user_controller - ERROR - user_controller.py:66 - Error getting users: 获取用户列表失败: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-06 13:20:14 - exception_handler - ERROR - handle.py:86 - Unhandled Exception: type object 'ResponseUtil' has no attribute 'server_error'
Traceback (most recent call last):
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/anyio/streams/memory.py", line 98, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/starlette/middleware/base.py", line 78, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/anyio/streams/memory.py", line 118, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/code/Shan-Yingqing-UUM-PhD-2025-V0126/dvss-ppa-implementation/backend-python/middlewares/auth_middleware.py", line 35, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/starlette/middleware/gzip.py", line 26, in __call__
    await self.app(scope, receive, send)
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/fastapi/routing.py", line 193, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/starlette/concurrency.py", line 41, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/anyio/to_thread.py", line 33, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 877, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 807, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/code/Shan-Yingqing-UUM-PhD-2025-V0126/dvss-ppa-implementation/backend-python/module_dvss/controller/user_controller.py", line 67, in get_users
    return ResponseUtil.server_error("获取用户列表失败")
           ^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: type object 'ResponseUtil' has no attribute 'server_error'
2025-07-06 21:59:52 - __main__ - WARNING - server.py:76 - ⚠️ 无法导入订单管理路由: cannot import name 'OriginalOrderCreate' from 'module_dvss.schemas.order_schema' (/Users/liuyue/code/dvss-ppa-implementation/backend-python/module_dvss/schemas/order_schema.py)
2025-07-06 21:59:52 - __main__ - WARNING - server.py:84 - ⚠️ 无法导入分片管理路由: cannot import name 'ShardCreateRequest' from 'module_dvss.schemas.shard_schema' (/Users/liuyue/code/dvss-ppa-implementation/backend-python/module_dvss/schemas/shard_schema.py)
2025-07-06 21:59:52 - __main__ - WARNING - server.py:92 - ⚠️ 无法导入日志管理路由: cannot import name 'PageResponse' from 'module_dvss.schemas.common_schema' (/Users/liuyue/code/dvss-ppa-implementation/backend-python/module_dvss/schemas/common_schema.py)
2025-07-06 21:59:52 - __main__ - INFO - server.py:111 - ✅ FastAPI 应用创建完毕
2025-07-06 22:00:26 - __main__ - WARNING - server.py:76 - ⚠️ 无法导入订单管理路由: cannot import name 'OriginalOrderCreate' from 'module_dvss.schemas.order_schema' (/Users/liuyue/code/dvss-ppa-implementation/backend-python/module_dvss/schemas/order_schema.py)
2025-07-06 22:00:26 - __main__ - WARNING - server.py:84 - ⚠️ 无法导入分片管理路由: cannot import name 'ShardCreateRequest' from 'module_dvss.schemas.shard_schema' (/Users/liuyue/code/dvss-ppa-implementation/backend-python/module_dvss/schemas/shard_schema.py)
2025-07-06 22:00:26 - __main__ - WARNING - server.py:92 - ⚠️ 无法导入日志管理路由: cannot import name 'PageResponse' from 'module_dvss.schemas.common_schema' (/Users/liuyue/code/dvss-ppa-implementation/backend-python/module_dvss/schemas/common_schema.py)
2025-07-06 22:00:26 - __main__ - INFO - server.py:111 - ✅ FastAPI 应用创建完毕
2025-07-06 22:00:27 - __mp_main__ - WARNING - server.py:76 - ⚠️ 无法导入订单管理路由: cannot import name 'OriginalOrderCreate' from 'module_dvss.schemas.order_schema' (/Users/liuyue/code/dvss-ppa-implementation/backend-python/module_dvss/schemas/order_schema.py)
2025-07-06 22:00:27 - __mp_main__ - WARNING - server.py:84 - ⚠️ 无法导入分片管理路由: cannot import name 'ShardCreateRequest' from 'module_dvss.schemas.shard_schema' (/Users/liuyue/code/dvss-ppa-implementation/backend-python/module_dvss/schemas/shard_schema.py)
2025-07-06 22:00:27 - __mp_main__ - WARNING - server.py:92 - ⚠️ 无法导入日志管理路由: cannot import name 'PageResponse' from 'module_dvss.schemas.common_schema' (/Users/liuyue/code/dvss-ppa-implementation/backend-python/module_dvss/schemas/common_schema.py)
2025-07-06 22:00:27 - __mp_main__ - INFO - server.py:111 - ✅ FastAPI 应用创建完毕
2025-07-06 22:00:27 - server - WARNING - server.py:76 - ⚠️ 无法导入订单管理路由: cannot import name 'OriginalOrderCreate' from 'module_dvss.schemas.order_schema' (/Users/liuyue/code/dvss-ppa-implementation/backend-python/module_dvss/schemas/order_schema.py)
2025-07-06 22:00:27 - server - WARNING - server.py:84 - ⚠️ 无法导入分片管理路由: cannot import name 'ShardCreateRequest' from 'module_dvss.schemas.shard_schema' (/Users/liuyue/code/dvss-ppa-implementation/backend-python/module_dvss/schemas/shard_schema.py)
2025-07-06 22:00:27 - server - WARNING - server.py:92 - ⚠️ 无法导入日志管理路由: cannot import name 'PageResponse' from 'module_dvss.schemas.common_schema' (/Users/liuyue/code/dvss-ppa-implementation/backend-python/module_dvss/schemas/common_schema.py)
2025-07-06 22:00:27 - server - INFO - server.py:111 - ✅ FastAPI 应用创建完毕
2025-07-06 22:00:27 - server - INFO - server.py:29 - 🚀 启动 DVSS-PPA 应用...
2025-07-06 22:00:27 - server - ERROR - server.py:36 - ❌ 数据库初始化失败
Traceback (most recent call last):
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3292, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
    with util.safe_reraise():
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 902, in __connect
    with util.safe_reraise():
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/engine/create.py", line 637, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/liuyue/code/dvss-ppa-implementation/backend-python/server.py", line 33, in lifespan
    Base.metadata.create_all(bind=engine)
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/sql/schema.py", line 5828, in create_all
    bind._run_ddl_visitor(
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3242, in _run_ddl_visitor
    with self.begin() as conn:
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3232, in begin
    with self.connect() as conn:
         ^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3268, in connect
    return self._connection_cls(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2430, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3292, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
    with util.safe_reraise():
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 902, in __connect
    with util.safe_reraise():
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/engine/create.py", line 637, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-06 22:02:26 - server - INFO - server.py:41 - 👋 应用关闭完成
2025-07-06 22:02:28 - __mp_main__ - WARNING - server.py:76 - ⚠️ 无法导入订单管理路由: cannot import name 'OriginalOrderCreate' from 'module_dvss.schemas.order_schema' (/Users/liuyue/code/dvss-ppa-implementation/backend-python/module_dvss/schemas/order_schema.py)
2025-07-06 22:02:28 - __mp_main__ - WARNING - server.py:84 - ⚠️ 无法导入分片管理路由: cannot import name 'ShardCreateRequest' from 'module_dvss.schemas.shard_schema' (/Users/liuyue/code/dvss-ppa-implementation/backend-python/module_dvss/schemas/shard_schema.py)
2025-07-06 22:02:28 - __mp_main__ - WARNING - server.py:92 - ⚠️ 无法导入日志管理路由: cannot import name 'PageResponse' from 'module_dvss.schemas.common_schema' (/Users/liuyue/code/dvss-ppa-implementation/backend-python/module_dvss/schemas/common_schema.py)
2025-07-06 22:02:28 - __mp_main__ - INFO - server.py:111 - ✅ FastAPI 应用创建完毕
2025-07-06 22:02:28 - server - WARNING - server.py:76 - ⚠️ 无法导入订单管理路由: cannot import name 'OriginalOrderCreate' from 'module_dvss.schemas.order_schema' (/Users/liuyue/code/dvss-ppa-implementation/backend-python/module_dvss/schemas/order_schema.py)
2025-07-06 22:02:28 - server - WARNING - server.py:84 - ⚠️ 无法导入分片管理路由: cannot import name 'ShardCreateRequest' from 'module_dvss.schemas.shard_schema' (/Users/liuyue/code/dvss-ppa-implementation/backend-python/module_dvss/schemas/shard_schema.py)
2025-07-06 22:02:28 - server - WARNING - server.py:92 - ⚠️ 无法导入日志管理路由: cannot import name 'PageResponse' from 'module_dvss.schemas.common_schema' (/Users/liuyue/code/dvss-ppa-implementation/backend-python/module_dvss/schemas/common_schema.py)
2025-07-06 22:02:28 - server - INFO - server.py:111 - ✅ FastAPI 应用创建完毕
2025-07-06 22:02:28 - server - INFO - server.py:29 - 🚀 启动 DVSS-PPA 应用...
2025-07-06 22:02:28 - server - ERROR - server.py:36 - ❌ 数据库初始化失败
Traceback (most recent call last):
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3292, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
    with util.safe_reraise():
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 902, in __connect
    with util.safe_reraise():
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/engine/create.py", line 637, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/liuyue/code/dvss-ppa-implementation/backend-python/server.py", line 33, in lifespan
    Base.metadata.create_all(bind=engine)
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/sql/schema.py", line 5828, in create_all
    bind._run_ddl_visitor(
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3242, in _run_ddl_visitor
    with self.begin() as conn:
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3232, in begin
    with self.connect() as conn:
         ^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3268, in connect
    return self._connection_cls(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2430, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3292, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 1269, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 169, in _do_get
    with util.safe_reraise():
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 167, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 393, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 678, in __init__
    self.__connect()
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 902, in __connect
    with util.safe_reraise():
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 898, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/engine/create.py", line 637, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 616, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/liuyue/.pyenv/versions/3.12.3/lib/python3.12/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/20/e3q8)
